#!/usr/bin/env python
# coding: utf-8

__doc__ = """
Calculates the volume of the atoms in a PDB file.
Copyright (c) 2007 Bosco Ho.  

Usage: pdbvol [-s <spacing>] <pdb> ...

-s <spacing>   the spacing in the grid used to calculate the 
               volume grid (default=0.5). The smaller value,
               the more accurate, but slower.
"""


from pdbremix.lib.docopt import docopt
from pdbremix import pdbatoms
from pdbremix.volume import volume

if __name__ == "__main__":
  arg = docopt(__doc__)
  spacing = float(arg['-s']) if arg['-s'] else 0.5
  for pdb in arg['<pdb>']:
    print pdb + ":",
    atoms = pdbatoms.AtomList(pdb).atoms()
    pdbatoms.add_radii(atoms)
    grid_pdb = pdb.replace('.pdb', '.grid.pdb')
    volume(atoms, spacing, grid_pdb)


  
